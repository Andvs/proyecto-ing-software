{% extends 'base.html' %}
{% load static %}

{% block titulo %}Panel de Administración{% endblock %}

{% block extra_css %}
<style>
  body { background-color: #f4f6fa; }
  .dashboard-container { max-width: 1100px; margin-top: 5rem; }
  .action-card { transition: transform .2s ease-in-out, box-shadow .2s ease-in-out; border: none; border-radius: 1rem; }
  .action-card:hover { transform: translateY(-5px); box-shadow: 0 .5rem 1rem rgba(0,0,0,.15)!important; }
  .action-card .icon { font-size: 3.25rem; color: #0a2342; }
  .section-title { color:#0a2342; }
</style>
{% endblock %}

{% block contenido %}
<nav class="navbar navbar-expand-lg navbar-dark shadow-sm" style="background-color: #0a2342;">
  <div class="container">
    <a class="navbar-brand" href="{% url 'dashboard' %}">
      <img src="{% static 'img/logo.png' %}" alt="Escuela San Salvador" style="height: 50px;">
      Panel de Administración
    </a>
    <div class="d-flex">
      <a href="{% url 'logout' %}" class="btn btn-outline-light">Cerrar Sesión</a>
    </div>
  </div>
</nav>

<div class="container dashboard-container">
  <div class="text-center mb-5">
    {% with nombre=request.user.get_full_name|default:request.user.username %}
      <h1 class="display-6 mb-2">Hola, {{ nombre }}</h1>
    {% endwith %}
    {% if request.user.is_superuser or request.user.perfil.rol.nombre == 'Admin' %}
      <p class="lead text-muted">Selecciona un módulo para comenzar</p>
    {% else %}
      <p class="lead text-muted">Bienvenido al panel</p>
    {% endif %}
  </div>

  <div class="row g-4 justify-content-center">

    {# === Gestión de Usuarios (Admin o Superusuario) === #}
    {% if request.user.is_superuser or request.user.perfil.rol.nombre == 'Admin' %}
      <div class="col-12 text-center">
        <h3 class="section-title fw-bold mb-3">Gestión de Usuarios</h3>
      </div>

      <div class="col-md-5">
        <a href="{% url 'registrar' %}" class="card action-card text-decoration-none shadow-sm h-100">
          <div class="card-body text-center p-5">
            <div class="icon mb-2">
              <svg xmlns="http://www.w3.org/2000/svg" width="56" height="56" fill="currentColor" class="bi bi-person-plus-fill" viewBox="0 0 16 16">
                <path d="M1 14s-1 0-1-1 1-4 6-4 6 3 6 4-1 1-1 1zm5-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6"/>
                <path fill-rule="evenodd" d="M13.5 5a.5.5 0 0 1 .5.5V7h1.5a.5.5 0 0 1 0 1H14v1.5a.5.5 0 0 1-1 0V8h-1.5a.5.5 0 0 1 0-1H13V5.5a.5.5 0 0 1 .5-.5"/>
              </svg>
            </div>
            <h3 class="card-title mt-2">Agregar Usuario</h3>
            <p class="card-text text-muted">Crear un nuevo perfil en el sistema.</p>
          </div>
        </a>
      </div>

      <div class="col-md-5">
        <a href="{% url 'lista_usuarios' %}" class="card action-card text-decoration-none shadow-sm h-100">
          <div class="card-body text-center p-5">
            <div class="icon mb-2">
              <svg xmlns="http://www.w3.org/2000/svg" width="56" height="56" fill="currentColor" class="bi bi-people-fill" viewBox="0 0 16 16">
                <path d="M7 14s-1 0-1-1 1-4 5-4 5 3 5 4-1 1-1 1zm4-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6m-5.784 6A2.238 2.238 0 0 1 5 13c0-1.355.68-2.75 1.936-3.72A6.325 6.325 0 0 0 5 9c-4 0-5 3-5 4s1 1 1 1zM4.5 8a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5"/>
              </svg>
            </div>
            <h3 class="card-title mt-2">Visualizar Usuarios</h3>
            <p class="card-text text-muted">Ver y administrar la lista de usuarios.</p>
          </div>
        </a>
      </div>
    {% endif %}

    {# === Asistencia (Entrenador o Admin) === #}
    {% if request.user.is_superuser or request.user.perfil.rol.nombre == 'Entrenador' or request.user.perfil.rol.nombre == 'Admin' %}
      <div class="col-12 text-center mt-4">
        <h3 class="section-title fw-bold mb-3">Asistencia</h3>
      </div>

      <div class="col-md-10">
        <a href="{% url 'asistencia_seleccionar' %}" class="card action-card text-decoration-none shadow-sm h-100">
          <div class="card-body d-flex align-items-center justify-content-between p-4">
            <div class="d-flex align-items-center gap-3">
              <div class="icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="56" height="56" fill="currentColor" class="bi bi-clipboard-check" viewBox="0 0 16 16">
                  <path fill-rule="evenodd" d="M10.854 7.146a.5.5 0 0 1 0 .708L7.707 11l-1.5-1.5a.5.5 0 1 1 .707-.707l.793.793 2.793-2.793a.5.5 0 0 1 .707 0"/>
                  <path d="M4 1.5h1a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1h1A1.5 1.5 0 0 1 13.5 3v10A1.5 1.5 0 0 1 12 14.5H4A1.5 1.5 0 0 1 2.5 13V3A1.5 1.5 0 0 1 4 1.5zM4 3v10h8V3h-1v.5a.5.5 0 0 1-.5.5h-5a.5.5 0 0 1-.5-.5V3z"/>
                </svg>
              </div>
              <div>
                <h4 class="mb-1">Toma de asistencia</h4>
                <p class="mb-0 text-muted">Selecciona actividad y marca presentes.</p>
              </div>
            </div>
            <span class="btn btn-primary">Ingresar</span>
          </div>
        </a>
      </div>
    {% endif %}

  </div>
</div>
{% endblock %}
